<style type="text/css">
	#employInfo_id, #educationInfoTable, #workInfoTable, #itemInfoTable{ width: 1024px; word-wrap:break-word; word-break:break-all;}
	#educationInfoTable td, #workInfoTable td, #itemInfoTable td{ background-color:#f9f9f9; }
	#employInfo_id tr:nth-child(1) > *{ border: none; border-bottom: 1px solid #ccc; }
	#employInfo_id th, #employInfo_id td{ border: 1px solid #ccc; text-align: center; height: 40px; line-height: auto; }
	#employInfo_id img, #employInfo_id select, #employInfo_id input[type="text"]{width: 100%;height: 100%;border: none;background-color:#f9f9f9; }
	#employInfo_id td[contenteditable="true"]{ background-color: #f9f9f9; }
	#employInfoForm .add_btn{ float: right; font-size: 12px; font-weight: normal; height: 33px; line-height: 33px; }
</style>
<form id="employInfoForm" class="form-horizontal ">
	<input type="hidden"  name="employInfo.id" value="#(employInfo.id)"/>
	<table id="employInfo_id" align="center">
		<caption>
			<h1>员工信息</h1>
		</caption>
		<tr>
			<td colspan="5"></td>
			<th>工号</th>
			<td contenteditable="true" id="employ_job_number">#(employInfo.employ_job_number)</td>
		</tr>
		<tr>
			<th style="width: 120px">姓名</th>
			<td style="width: 170px" contenteditable="true" id="employ_name">#(employInfo.employ_name)</td>
			<th style="width: 120px" >性别</th>
			<td style="width: 170px" >
				<label style="margin-left: 10px" class="radio-inline"><input type="radio" value="1" name="employInfo.employ_sex" checked #(1 == employInfo.employ_sex ? "checked='checked'" : "")/>男</label>
				<label style="margin-left: 40px" class="radio-inline"><input type="radio" value="2" name="employInfo.employ_sex" #(2 == employInfo.employ_sex ? "checked='checked'" : "")/>女</label>
			</td>
			<th style="width: 120px">籍贯</th>
			<td style="width: 170px" contenteditable="true" id="employ_nativeplace">#(employInfo.employ_nativeplace)</td>
			<th rowspan="5" style="height: 200px">
				<img id ="employInfoImg" class="selectFile" callBack="employInfoSelectImg" fileType=".png|.jpg|.gif" src="/downloadData/img?filePath=#(employInfo.employ_img)" _src="#(employInfo.employ_img)"/>
			</th>
		</tr>
		<tr>
			<th>年龄</th>
			<td contenteditable="true" id="employ_age">#(employInfo.employ_age)</td>
			<th>婚姻状态</th>
			<td  colspan="3">
				<label style="margin-left: 10px" class="radio-inline"><input type="radio" value="1" name="employInfo.employ_marrage" checked #(1 == employInfo.employ_marrage ? "checked='checked'" : "")/>未婚</label>
				<label style="margin-left: 10px" class="radio-inline"><input type="radio" value="2" name="employInfo.employ_marrage" #(2 == employInfo.employ_marrage ? "checked='checked'" : "")/>已婚</label>
				<label style="margin-left: 10px" class="radio-inline"><input type="radio" value="3" name="employInfo.employ_marrage" #(3 == employInfo.employ_marrage ? "checked='checked'" : "")/>离异</label>
			</td>		
		</tr>
		<tr>
			<th>出生时间</th>
			<td>
  				<input class="form_datetime" type="text" name="employInfo.employ_birthday" value="#(employInfo.employ_birthday)"/>
			</td>			
			<th>健康状态</th>
			<td colspan="3" contenteditable="true" id="employ_health">#(employInfo.employ_health)</td>	
		</tr>
		<tr>
			<th>血型</th>
			<td id="employ_blood_type" contenteditable="true">
				#(employInfo.employ_blood_type)
			</td>
			<th>身份证号码</th>
			<td colspan="3" contenteditable="true" id ="employ_identity_card">#(employInfo.employ_identity_card)</td>
		</tr>
		<tr>
			<th>毕业院校</th>
			<td colspan="2" contenteditable="true" id="employ_graduation">#(employInfo.employ_graduation)</td>
			<th>学历</th>
			<td colspan="2">
				<select id="employ_education_id" name="employInfo.employ_education_id">
					#for(education : employEducationList) 
						#if(education.id+""==employInfo.employ_education_id+"")
							<option value="#(education.id)" selected="selected">#(education.dictionary_name)</option>
						#else
							<option value="#(education.id)">#(education.dictionary_name)</option>
						#end
					#end
				</select>
			</td>
		</tr>
		<tr>
			<th>户口所在地 </th>
			<td colspan="2" contenteditable="true" id="employ_domicile">#(employInfo.employ_domicile)</td>
			<th>档案所在地</th>
			<td colspan="3" contenteditable="true" id="employ_dossier_place">#(employInfo.employ_dossier_place)</td>	
		</tr>
		<tr>
			<th>学位</th>
			<td>
				<select id="employ_degree_id" name="employInfo.employ_degree_id">
					#for(degree : employDegreeList) 
						#if(degree.id+""==employInfo.employ_degree_id+"")
							<option value="#(degree.id)" selected="selected">#(degree.dictionary_name)</option>
						#else
							<option value="#(degree.id)">#(degree.dictionary_name)</option>
						#end
					#end
				</select>
			</td>
			<th>政治面貌</th>
			<td contenteditable="true" id ="employ_politics">#(employInfo.employ_politics)</td>
			<th>外语水平</th>
			<td colspan="2" contenteditable="true" id ="employ_wsk">#(employInfo.employ_wsk)</td>
		</tr>
		<tr>
			<th>语种</th>
			<td>
				<select id="employ_language_id" name="employInfo.employ_language_id">
					#for(language : employLanguageList) 
						#if(language.id+""==employInfo.employ_language_id+"")
							<option value="#(language.id)" selected="selected">#(language.dictionary_name)</option>
						#else
							<option value="#(language.id)">#(language.dictionary_name)</option>
						#end
					#end
				</select>
			</td>	
			<th>专业</th>
			<td colspan="4">
				<select id="employ_speciality" name="employInfo.employ_speciality">
					#for(employSpeciality : employSpecialityList) 
						#if(employSpeciality.id+""==employInfo.employ_speciality+"")
							<option value="#(employSpeciality.id)" selected="selected">#(employSpeciality.dictionary_name)</option>
						#else
							<option value="#(employSpeciality.id)">#(employSpeciality.dictionary_name)</option>
						#end
					#end
				</select>
			</td>
		</tr>
		<tr>
			<th>专业证书</th>
			<td colspan="6">
				<div class="input-group" style="width: 100%;height: 100%">
  					<input type="text" disabled="disabled" style="height: 100%;width: 100%" placeholder="请选择专业证书" id="employ_diploma" name="employInfo.employ_diploma" value="#(employInfo.employ_diploma)">
  					<span class="input-group-addon btn" id="select_employ_diploma">选择</span>
				</div> 				
			</td>		
		</tr>
		<tr>
			<th>参加工作时间</th>
			<td>
				<input class="form_datetime" type="text" name="employInfo.employ_job_time" value="#(employInfo.employ_job_time)"/>
			</td>
			<th>加入公司时间</th>
			<td>
				<input class="form_datetime" type="text" name="employInfo.employ_join_time" value="#(employInfo.employ_join_time)"/>
			</td>
			<th>联系方式</th>
			<td colspan="2" contenteditable="true" id="employ_phone">#(employInfo.employ_phone)</td>
		</tr>
		<tr>
			<th>电子邮箱</th>
			<td colspan="2" contenteditable="true" id="employ_email">#(employInfo.employ_email)</td>
			<th>QQ</th>
			<td colspan="3" contenteditable="true" id ="employ_qq">#(employInfo.employ_qq)</td>
		</tr>
	</table>
	
	<table align="center" id="educationInfoTable">
		<caption>
			<h1>
				&nbsp; &nbsp; 教育经历
				<a href="javascript:void(0);" class="add_btn" id="educationInfoAdd">添加</a>
			</h1>
		</caption>
		<tbody> </tbody>
	</table>
	
	<table align="center" id="workInfoTable">
		<caption>
			<h1>
				&nbsp; &nbsp; 工作经历
				<a href="javascript:void(0);" class="add_btn" id="workInfoAdd">添加</a>
			</h1>
		</caption>
		<tbody> </tbody>
	</table>
	
	<table align="center" id="itemInfoTable">
		<caption>
			<h1>
				&nbsp; &nbsp; 项目经验
				<a href="javascript:void(0);" class="add_btn" id="itemInfoAdd">添加</a>
			</h1>
		</caption>
		<tbody> </tbody>
	</table>
	
</form>
<script type="text/javascript">
	var employDiplomaSelectModal =	util.modal({
		title : "专业证书",
		pageUrl : "/employInfoPage/employDiplomaSelectIndex",
		button : {
			"submit" : {
				name : "确定",
				className : "btn-primary",
				click :function(dataMap){
					util.closeModal(dataMap);
				}
			}
		}
	});
	$("#select_employ_diploma").click(function(){
		util.execute(employDiplomaSelectModal,{});
	});
	$("#employInfoForm").validationEngine({
		showOneMessage : true,
		promptPosition : "topLeft"
	});
	$(".form_datetime").datetimepicker({
		language : 'zh-CN',
		minView : 'month',
		format : 'yyyy-mm-dd',
		autoclose : true,
		startView : 2,
		showMeridian : 1,
		pickerPosition : "bottom-left"
	});
	function employInfoSelectImg(returnMsg) {
		$("#employInfoImg").attr("src", "/downloadData/img?filePath="+returnMsg.filePath).attr("_src", returnMsg.filePath);
	}
	
	//教育经历
	util.initPage("/employInfoData/educationInfoList", {
		sort : {
			"id" : "asc"
		},
		search : {
			column : {
				"employ_id" : [ "=", "", "#(employInfo.id)" ]
			}
		},
		modal : {
			"educationInfoSave" : {
				bind : {
					"#educationInfoAdd" : {
						title : "教育经历添加"
					}
				},
				pageUrl : "/employInfoPage/educationInfoEdit",
				title : "教育经历修改",
				button : {
					"submit" : {
						name : "确定",
						className : "btn-primary",
						click : function(dataMap) {
							if ($('#educationInfoForm').validationEngine('validate')) {
								var educationInfo = util.getModal(dataMap);
								educationInfo["educationInfo.employ_id"] = "#(employInfo.id)";
								util.call("/employInfoData/educationInfoSave", educationInfo, function(returnMsg) {
									util.refreshPage(dataMap);
									util.closeModal(dataMap);
									util.alert(returnMsg["returnMsg"]);
								});
							}
						}
					}
				}
			},
			"educationInfoDelete" : {
				button : {
					"submit" : {
						name : "确定",
						className : "btn-primary",
						click : function(dataMap) {
							util.call("/employInfoData/educationInfoDelete", { "id" : dataMap["id"] + "" }, function(returnMsg) {
								util.refreshPage(dataMap);
								util.closeModal(dataMap);
								util.alert(returnMsg["returnMsg"]);
							});
						}
					}
				}
			}
		}
	},
	function(data) {
		var tableHTML = [],
			obj = {},
			educationInfoList = data.list,
			educationInfoSave = data["educationInfoSave"],
			educationInfoDelete = data["educationInfoDelete"];
		for (var i = 0; i < educationInfoList.length; i++) {
			obj = educationInfoList[i];
			tableHTML.push('<tr style="border-bottom: 1px solid #ccc;">');
			tableHTML.push('	<td>',obj.education_start,'到', obj.education_end , '</td>');
			tableHTML.push('	<td>', obj.school_name , '</td>');
			tableHTML.push('	<td>', obj.major , '</td>');
			tableHTML.push('	<td style="text-align: right;">');
			tableHTML.push('		<a href="javascript:void(0);" onclick="util.execute(\'',educationInfoSave,'\', {id : ',obj.id,', title: \'教育经历修改\'});">修改</a>');
			tableHTML.push('		<a href="javascript:void(0);" onclick="util.execute(\'',educationInfoDelete,'\', {id : ',obj.id,', pageHtml: \'确定要删除【',obj.school_name,'】吗？\'});">删除</a>');
			tableHTML.push('	</td>');
			tableHTML.push('</tr>');
		}
		$("#educationInfoTable tbody").html(tableHTML.join(""));
	});
	
	
	

	//工作经历
	util.initPage("/employInfoData/workInfoList", {
		sort : {
			"id" : "asc"
		},
		search : {
			column : {
				"employ_id" : [ "=", "", "#(employInfo.id)" ]
			}
		},
		modal : {
			"workInfoSave" : {
				bind : {
					"#workInfoAdd" : {
						title : "工作经历添加"
					}
				},
				pageUrl : "/employInfoPage/workInfoEdit",
				title : "工作经历修改",
				button : {
					"submit" : {
						name : "确定",
						className : "btn-primary",
						click : function(dataMap) {
							if ($('#workInfoForm').validationEngine('validate')) {
								var workInfo = util.getModal(dataMap);
								workInfo["workInfo.employ_id"] = "#(employInfo.id)";
								util.call("/employInfoData/workInfoSave", workInfo, function(returnMsg) {
									util.refreshPage(dataMap);
									util.closeModal(dataMap);
									util.alert(returnMsg["returnMsg"]);
								});
							}
						}
					}
				}
			},
			"workInfoDelete" : {
				button : {
					"submit" : {
						name : "确定",
						className : "btn-primary",
						click : function(dataMap) {
							util.call("/employInfoData/workInfoDelete", { "id" : dataMap["id"] + "" }, function(returnMsg) {
								util.refreshPage(dataMap);
								util.closeModal(dataMap);
								util.alert(returnMsg["returnMsg"]);
							});
						}
					}
				}
			}
		}
	},
	function(data) {
		var tableHTML = [],
			obj = {},
			workInfoList = data.list,
			workInfoSave = data["workInfoSave"],
			workInfoDelete = data["workInfoDelete"];
		for (var i = 0; i < workInfoList.length; i++) {
			obj = workInfoList[i];
			tableHTML.push('<tr>');
			tableHTML.push('	<td>', obj.work_start , '到',obj.work_end,'</td>');
			tableHTML.push('	<td>', obj.company_name , '</td>');
			tableHTML.push('	<td>', obj.position_name , '</td>');
			tableHTML.push('	<td>', obj.wages , '元/月</td>');
			tableHTML.push('	<td style="text-align: right;">');
			tableHTML.push('		<a href="javascript:void(0);" onclick="util.execute(\'',workInfoSave,'\', {id : ',obj.id,', title: \'工作经历修改\'});">修改</a>');
			tableHTML.push('		<a href="javascript:void(0);" onclick="util.execute(\'',workInfoDelete,'\', {id : ',obj.id,', pageHtml: \'确定要删除【',obj.company_name,'】吗？\'});">删除</a>');
			tableHTML.push('	</td>');
			tableHTML.push('</tr>');
			tableHTML.push('<tr style="border-bottom: 1px solid #ccc;">');
			tableHTML.push('	<td colspan="5">&nbsp; &nbsp; ',obj.work_content,'</td>');
			tableHTML.push('</tr>');
		}
		$("#workInfoTable tbody").html(tableHTML.join(""));
	});
	

	//项目经验
	util.initPage("/employInfoData/itemInfoList", {
		sort : {
			"id" : "asc"
		},
		search : {
			column : {
				"employ_id" : [ "=", "", "#(employInfo.id)" ]
			}
		},
		modal : {
			"itemInfoSave" : {
				bind : {
					"#itemInfoAdd" : {
						title : "项目经验添加"
					}
				},
				pageUrl : "/employInfoPage/itemInfoEdit",
				title : "项目经验修改",
				button : {
					"submit" : {
						name : "确定",
						className : "btn-primary",
						click : function(dataMap) {
							if ($('#itemInfoForm').validationEngine('validate')) {
								var itemInfo = util.getModal(dataMap);
								itemInfo["itemInfo.employ_id"] = "#(employInfo.id)";
								util.call("/employInfoData/itemInfoSave", itemInfo, function(returnMsg) {
									util.refreshPage(dataMap);
									util.closeModal(dataMap);
									util.alert(returnMsg["returnMsg"]);
								});
							}
						}
					}
				}
			},
			"itemInfoDelete" : {
				button : {
					"submit" : {
						name : "确定",
						className : "btn-primary",
						click : function(dataMap) {
							util.call("/employInfoData/itemInfoDelete", { "id" : dataMap["id"] + "" }, function(returnMsg) {
								util.refreshPage(dataMap);
								util.closeModal(dataMap);
								util.alert(returnMsg["returnMsg"]);
							});
						}
					}
				}
			}
		}
	},
	function(data) {
		var tableHTML = [],
			obj = {},
			itemInfoList = data.list,
			itemInfoSave = data["itemInfoSave"],
			itemInfoDelete = data["itemInfoDelete"];
		for (var i = 0; i < itemInfoList.length; i++) {
			obj = itemInfoList[i];
			tableHTML.push('<tr>');
			tableHTML.push('	<td>', obj.item_start , '到',obj.item_end,'</td>');
			tableHTML.push('	<td>', obj.item_name , '</td>');
			tableHTML.push('	<td style="text-align: right;">');
			tableHTML.push('		<a href="javascript:void(0);" onclick="util.execute(\'',itemInfoSave,'\', {id : ',obj.id,', title: \'项目经验修改\'});">修改</a>');
			tableHTML.push('		<a href="javascript:void(0);" onclick="util.execute(\'',itemInfoDelete,'\', {id : ',obj.id,', pageHtml: \'确定要删除【',obj.item_name,'】吗？\'});">删除</a>');
			tableHTML.push('	</td>');
			tableHTML.push('</tr>');
			tableHTML.push('<tr>');
			tableHTML.push('	<td colspan="3">&nbsp; &nbsp; ', obj.item_brief , '</td>');
			tableHTML.push('</tr>');
			tableHTML.push('<tr style="border-bottom: 1px solid #ccc;">');
			tableHTML.push('	<td colspan="3">&nbsp; &nbsp; ', obj.item_duty , '</td>');
			tableHTML.push('</tr>');
		}
		$("#itemInfoTable tbody").html(tableHTML.join(""));
	});
</script>